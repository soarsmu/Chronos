import re
import pandas as pd
import spacy
from spacy.tokenizer import Tokenizer
import sys
sys.path.append("..")
from count_word import count_words
from stopwords import generate_stop_words, generate_text_stop_words,ENG_STOPWORDS
from text_processor import extended_is_stop, text_processor
REFERENCE_DATA_PATH = "../dataset/reference_data/reference_data_raw.csv"

reference_data = pd.read_csv(REFERENCE_DATA_PATH, index_col = 0)
references = reference_data["consolidated_strings"].values.astype("U")
# print(references[0])
CVE_ID = reference_data['cve_id'].values.astype("U")
# Select stop words
text = spacy.load("en_core_web_sm")
text.Defaults.stop_words.update(ENG_STOPWORDS)
stop_words = text.Defaults.stop_words
pattern = re.compile(r"[a-zA-Z][a-z]+")

REFERENCES = []

def generate_new_csv(percentage, number):
    # REFERENCES = []
    # ## 1. Get words list of all references
    # words_list = []
    # for i in range(len(reference_data)):
    #     docs = text_processor(references[i])
    #     for word in docs:
    #         words_list.append(word)
    #     print(f"{i}, {percentage}, {number}")

    # ## 2. Get stop words
    # stop_words = generate_stop_words(words_list, percentage)
    # for word in stop_words:
    #     REFERENCES.append(word)
    # print(stop_words)
    # print(len(stop_words))

    ## 3. Get new references
    new_references = []
    text = spacy.load("en_core_web_sm")
    text.Defaults.stop_words.update(ENG_STOPWORDS, REFERENCES)
    stop_words = text.Defaults.stop_words
    pattern = re.compile(r"[a-zA-Z][a-z]+")
    for i in range(len(reference_data)):
        text_words_list = text_processor(references[i])
        text_stop_words = generate_text_stop_words(text_words_list, number)
        for stop_word in text_stop_words:
            REFERENCES.append(stop_word)
        text = spacy.load("en_core_web_sm")
        text.Defaults.stop_words.update(ENG_STOPWORDS, REFERENCES)
        stop_words = text.Defaults.stop_words
        pattern = re.compile(r"[a-zA-Z][a-z]+")
        docs = text_processor(references[i])
        text = ""
        for word in docs:
            text = text + " " + word
        new_references.append(text)
        print(f"{i}, {CVE_ID[i]}")
        print(f"{percentage}, {number} \n {text}")
    print(len(new_references))

    # 4. Write to DataFrame
    for i in range(len(reference_data)):
        reference_data.iloc[i, 5] = new_references[i]

    # 5. Generate new csv
    reference_data.to_csv(f"reference_data_raw_{percentage}_{number}.csv")

REFERENCES_ALL = [['nan', 'jack', 'product', 'accept', 'app', 'submit', 'futex', 'jeff', 'drive', 'suite', 'bochum', 'signing', 'apple', 'fortinet', 'check', 'creight', 'julian', 'rahm', 'setting', 'blogging', 'baine', 'somorovsky', 'quick', 'gorbaty', 'pengfei', 'endpoint', 'possibility', 'distribution', 'hostname', 'socket', 'gregory', 'gaynor', 'hat', 'manage', 'entries', 'pettay', 'xx', 'sanitising', 'arya', 'limited', 'middle', 'privilege', 'print', 'manipulate', 'range', 'method', 'mozilla', 'flexera', 'desktop', 'spandan', 'timestamp', 'execution', 'child', 'qemu', 'expectation', 'tomcat', 'error', 'fragment', 'stream', 'structure', 'specific', 'external', 'navigation', 'feed', 'foscari', 'cameron', 'tim', 'mode', 'association', 'account', 'swiecki', 'business', 'input', 'editor', 'race', 'platform', 'provider', 'httpd', 'critical', 'google', 'firefox', 'decompression', 'pipe', 'increase', 'secret', 'dropping', 'traffic', 'variable', 'palmarini', 'tag', 'filename', 'hui', 'create', 'grant', 'mirosh', 'generate', 'netfilter', 'andrea', 'nathan', 'seward', 'deadlock', 'partial', 'lib', 'correct', 'downgrade', 'moodle', 'graphic', 'charset', 'ubais', 'uninitialized', 'keeler', 'aaron', 'abdulrahman', 'region', 'hanno', 'storage', 'xstore', 'chun', 'resource', 'postscript', 'pende', 'le', 'segment', 'devices', 'btrfs', 'wide', 'blank', 'flash', 'result', 'format', 'connectors', 'ronald', 'provide', 'family', 'omap', 'mobile', 'request', 'tcp', 'guard', 'coulson', 'workstation', 'payload', 'steve', 'emulator', 'identity', 'provencher', 'corba', 'fast', 'tyson', 'unspecified', 'jacob', 'miroslav', 'network', 'gaston', 'mario', 'href', 'elliptic', 'agent', 'zalewski', 'escape', 'vulcan', 'metzmacher', 'aws', 'inno', 'wireless', 'libvpx', 'script', 'unsafe', 'gobejishvili', 'ucha', 'compatibility', 'windows', 'field', 'unsupported', 'patch', 'django', 'tools', 'dmitry', 'endian', 'png', 'lts', 'userspace', 'exploitation', 'vitaly', 'injection', 'ipv', 'holbert', 'bob', 'ctl', 'manager', 'dereference', 'sandeep', 'henrique', 'van', 'rlinx', 'libssh', 'speculative', 'gdk', 'pailoor', 'ghostscript', 'space', 'character', 'copying', 'pascutto', 'kerbero', 'purpose', 'nginx', 'martin', 'zhao', 'tooru', 'ghannam', 'labs', 'databind', 'adapter', 'replay', 'plugin', 'bobby', 'spring', 'khalil', 'andreas', 'mark', 'cryptfs', 'bhargavan', 'hijack', 'administrative', 'munoz', 'audio', 'lab', 'conduct', 'utility', 'moritz', 'ding', 'logic', 'queue', 'tek', 'device', 'sasha', 'launch', 'timer', 'jukka', 'michael', 'version', 'mysql', 'utopic', 'soft', 'exiv', 'nikita', 'diffie', 'overrun', 'sctp', 'computing', 'snd', 'force', 'libtiff', 'user', 'ladd', 'channel', 'silvio', 'community', 'yan', 'wu', 'involve', 'openjdk', 'notify', 'applications', 'ruhr', 'zip', 'runtime', 'corruption', 'complete', 'protocol', 'onapsis', 'inconvenience', 'attacker', 'inferno', 'pseudo', 'confidentiality', 'diagnostic', 'threat', 'eric', 'fake', 'object', 'mooij', 'recvmmsg', 'backport', 'intend', 'updater', 'openssl', 'fc', 'ppc', 'juha', 'search', 'parameter', 'lock', 'news', 'sutherland', 'header', 'insufficient', 'accessible', 'password', 'pairwise', 'crypto', 'operation', 'design', 'cdrom', 'luke', 'iced', 'level', 'hamacher', 'development', 'ruderman', 'authenticate', 'servlet', 'middleware', 'canvas', 'karl', 'jackson', 'quan', 'php', 'standard', 'accenture', 'limit', 'vm', 'jesse', 'ridge', 'integrigy', 'mikhail', 'event', 'mechanism', 'enter', 'reinstallation', 'schwartzentruber', 'poppler', 'ntpd', 'ehsan', 'camera', 'keyring', 'golunski', 'procedure', 'save', 'forgery', 'step', 'select', 'jakub', 'ubuntu', 'tea', 'faster', 'romina', 'joshua', 'issue', 'lokihardt', 'ready', 'controller', 'disk', 'verification', 'horn', 'christian', 'vulnerable', 'manipulation', 'operate', 'note', 'escalation', 'initiative', 'drupal', 'matt', 'compromise', 'wrapper', 'track', 'bcom', 'philipp', 'micro', 'chalykin', 'binary', 'zhang', 'oracle', 'scripting', 'sword', 'immutable', 'dump', 'ware', 'application', 'observation', 'meta', 'capability', 'instruction', 'goire', 'ntp', 'packet', 'james', 'dominique', 'daemon', 'handler', 'jason', 'haza', 'special', 'jonas', 'read', "'cause", 'kernels', 'allocator', 'bleichenbacher', 'util', 'nishimura', 'maria', 'eyal', 'behavior', 'removal', 'symbolic', 'diehl', 'entry', 'fei', 'bluetooth', 'aka', 'portion', 'transformation', 'reject', 'forti', 'felix', 'functionality', 'volume', 'holler', 'origin', 'peng', 'query', 'icedove', 'clary', 'evergreen', 'tudor', 'bin', 'usage', 'leap', 'bitmap', 'nicolas', 'lin', 'sea', 'edit', 'hold', 'instal', 'wifi', 'daniel', 'time', 'maintenance', 'sandbox', 'exif', 'digest', 'bargull', 'deny', 'trust', 'boss', 'panic', 'review', 'consistent', 'connect', 'establish', 'unknown', 'valid', 'nest', 'deploy', 'peer', 'gian', 'xuanwu', 'indirect', 'addition', 'mariusz', 'scientific', 'jann', 'deployment', 'behzad', 'francis', 'edge', 'conjunction', 'profile', 'foreground', 'live', 'forge', 'thunderbird', 'xattr', 'original', 'cryptography', 'georg', 'log', 'unintended', 'hang', 'cloud', 'peter', 'bilisim', 'flag', 'core', 'mathias', 'raw', 'backporte', 'improperly', 'assertion', 'opencv', 'samba', 'entity', 'resolve', 'aki', 'allocation', 'timing', 'prior', 'satellite', 'disclose', 'juho', 'crane', 'module', 'padding', 'broadcom', 'jiang', 'newsgroup', 'model', 'passenger', 'reside', 'ormandy', 'filesystem', 'ivan', 'encryption', 'condition', 'frame', 'bar', 'eckersall', 'path', 'assign', 'xtreme', 'root', 'oy', 'chrome', 'message', 'zone', 'oncu', 'browse', 'modified', 'embed', 'looben', 'active', 'di', 'tyurin', 'loader', 'reporter', 'campana', 'recvfrom', 'hewlett', 'iframe', 'yang', 'intel', 'metadata', 'local', 'liu', 'tiff', 'benjamin', 'rule', 'solution', 'cairo', 'curve', 'permit', 'curl', 'incorrectly', 'consume', 'recovery', 'overflow', 'table', 'terminal', 'undertow', 'deserializing', 'rodrigo', 'capsule', 'aleksandar', 'randomization', 'previous', 'url', 'chris', 'creation', 'zuozhi', 'allocate', 'paul', 'sven', 'brotli', 'incomplete', 'reboot', 'unit', 'remain', 'attachment', 'guess', 'malforme', 'kettunen', 'word', 'commonly', 'occur', 'sudo', 'link', 'raspberry', 'violation', 'credential', 'talos', 'libwmf', 'type', 'handling', 'reinstall', 'wei', 'update', 'randell', 'hazard', 'username', 'interaction', 'adobe', 'hash', 'policy', 'pattern', 'physically', 'excessive', 'salsa', 'iptable', 'shift', 'bechler', 'bug', 'addressbar', 'encrypt', 'trigger', 'adam', 'remote', 'addon', 'usbtest', 'en', 'grieco', 'libgd', 'services', 'machine', 'mitigation', 'spectre', 'display', 'form', 'protection', 'rail', 'exist', 'major', 'johnathan', 'olli', 'bock', 'kawakami', 'libav', 'golang', 'fmpeg', 'nurminen', 'authorization', 'fujisawa', 'bmo', 'alexander', 'client', 'js', 'handshake', 'ioctl', 'generic', 'exposure', 'zbarsky', 'memory', 'rely', 'ping', 'supply', 'owais', 'infiniband', 'physical', 'regular', 'arbitrary', 'file', 'book', 'craft', 'concurrency', 'libcurl', 'confidential', 'litchfield', 'connector', 'nils', 'libxslt', 'configurable', 'option', 'impersonate', 'corrupt', 'font', 'symlink', 'resolution', 'install', 'existence', 'json', 'combination', 'login', 'symfony', 'evolution', 'lemonias', 'easily', 'graph', 'gary', 'partially', 'legacy', 'transport', 'privilige', 'situation', 'libidn', 'sync', 'topic', 'developer', 'serna', 'domain', 'ruby', 'passive', 'andrew', 'director', 'encoder', 'marchesini', 'floppy', 'researcher', 'schema', 'replace', 'retail', 'giannakidis', 'bound', 'sandboxe', 'carpenter', 'trustwave', 'unable', 'subject', 'gmb', 'secrecy', 'checksum', 'borked', 'connection', 'tomlinson', 'frank', 'foreman', 'availability', 'improvement', 'exception', 'struts', 'emulation', 'heap', 'processing', 'ntpq', 'program', 'alert', 'incompatible', 'address', 'reference', 'assist', 'helin', 'mlynski', 'multi', 'sound', 'specially', 'palaczynski', 'unprivileged', 'jurczyk', 'notes', 'steal', 'hellman', 'weimer', 'technetwork', 'wrong', 'leverage', 'release', 'ssl', 'refresh', 'worker', 'parse', 'body', 'source', 'git', 'microarchitectural', 'tar', 'alibaba', 'smith', 'card', 'communications', 'enache', 'fault', 'passthrough', 'decrypt', 'process', 'circumstance', 'conntrack', 'tavis', 'magick', 'separate', 'parser', 'record', 'hertz', 'rel', 'config', 'mitre', 'verify', 'stack', 'holley', 'control', 'descriptor', 'string', 'count', 'series', 'broker', 'juraj', 'sensitive', 'john', 'inject', 'cryptographic', 'share', 'subsystem', 'keen', 'amit', 'element', 'apologize', 'snapdragon', 'theme', 'veggalam', 'stephan', 'matthew', 'tracking', 'reuse', 'palmgren', 'overread', 'bandha', 'description', 'javascript', 'custom', 'route', 'write', 'advantage', 'wen', 'fingerprint', 'cycle', 'garbage', 'validate', 'change', 'gain', 'securi', 'image', 'malicous', 'handle', 'render', 'additional', 'bnc', 'dnsmasq', 'software', 'build', 'chakra', 'matthias', 'terminate', 'mohamed', 'goichon', 'fingerprinting', 'andre', 'seeley', 'expat', 'marcin', 'ds', 'university', 'restricted', 'consumption', 'chromium', 'window', 'xt', 'qihoo', 'ticket', 'watson', 'premise', 'affect', 'whitespace', 'apply', 'sequence', 'keyctl', 'include', 'setgid', 'spoof', 'property', 'lei', 'environment', 'ps', 'tilli', 'technology', 'dissector', 'archive', 'modifie', 'libarchive', 'aarch', 'sharing', 'razmdjou', 'browser', 'integer', 'systemd', 'interactive', 'corporation', 'kekai', 'insecure', 'upgrade', 'identifier', 'liao', 'discover', 'function', 'datum', 'enable', 'management', 'gabriel', 'confusion', 'internet', 'determine', 'cpuapr', 'roberto', 'vulnerability', 'initialization', 'role', 'undesire', 'boundary', 'integration', 'raspi', 'upgrading', 'support', 'thread', 'kit', 'foundation', 'chunk', 'architecture', 'layer', 'ralf', 'ti', 'ext', 'pluggable', 'ethernet', 'power', 'construct', 'remove', 'lack', 'cesare', 'container', 'list', 'utilize', 'sidechannel', 'nan', 'biznet', 'soap', 'set', 'office', 'kelesis', 'bind', 'audit', 'smuggling', 'untrusted', 'algorithm', 'vendor', 'permission', 'holger', 'azure', 'oem', 'alonso', 'ubufox', 'libstagefright', 'microprocessor', 'michal', 'disable', 'interpreter', 'logging', 'framework', 'continuous', 'security', 'qualcomm', 'guido', 'context', 'decode', 'src', 'overwrite', 'failure', 'impl', 'mouse', 'argument', 'smart', 'buffer', 'secunia', 'shannon', 'byron', 'emmert', 'bridge', 'response', 'size', 'prompt', 'gustavo', 'current', 'schneider', 'moderate', 'safe', 'randomize', 'cgi', 'robert', 'subsequent', 'temporary', 'isolated', 'mike', 'decoder', 'xinxi', 'encoding', 'installation', 'packaging', 'extract', 'norman', 'mail', 'unserialize', 'configuration', 'martinez', 'crash', 'transfer', 'miscellaneous', 'invoke', 'properly', 'driver', 'dot', 'kwong', 'serialization', 'xu', 'muneaki', 'sanity', 'segmentation', 'amazon', 'cihan', 'processor', 'impact', 'cpujan', 'jan', 'kyle', 'configure', 'directory', 'christoph', 'madvise', 'debugger', 'campen', 'massieux', 'expose', 'mishandle', 'studio', 'hugetlb', 'agreement', 'sun', 'osf', 'monitor', 'apostolos', 'xfs', 'gear', 'mapping', 'fail', 'kvm', 'badlock', 'medium', 'brandon', 'pillow', 'tool', 'backend', 'collection', 'library', 'marco', 'spenneberg', 'skia', 'phar', 'akhgari', 'johnson', 'loop', 'partition', 'bert', 'safety', 'specification', 'flush', 'juwei', 'load', 'zhou', 'vector', 'suspend', 'prevent', 'danny', 'checking', 'apache', 'firewall', 'deserialize', 'array', 'capture', 'itkin', 'layout', 'expansion', 'access', 'send', 'correctly', 'instance', 'project', 'code', 'perform', 'elevate', 'lead', 'escalate', 'thomas', 'florian', 'cross', 'privileged', 'preflight', 'tenable', 'iinuma', 'jesup', 'carsten', 'guest', 'huge', 'trick', 'bit', 'langley', 'modify', 'authentication', 'brian', 'virtualization', 'rate', 'deserialisation', 'bundle', 'reportin', 'egorov', 'branch', 'infini', 'integrity', 'builder', 'yuki', 'kangjie', 'unicode', 'rename', 'hyp', 'component', 'regression', 'singh', 'payer', 'instantiate', 'netlink', 'hole', 'rockit', 'linux', 'gnu', 'target', 'automate', 'patrick', 'osmond', 'position', 'mapper', 'drag', 'luca', 'bus', 'mat', 'manually', 'mmap', 'fuhrmannek', 'alqabandi', 'venice', 'jar', 'enablement', 'bypass', 'impersonation', 'base', 'service', 'kubernetes', 'wi', 'flaw', 'underflow', 'doc', 'precise', 'dolibarr', 'jas', 'compression', 'debian', 'merge', 'red', 'consulting', 'docker', 'piessens', 'console', 'resize', 'implementation', 'stephen', 'lookup', 'demonstrate', 'reset', 'max', 'band', 'ldap', 'deserialization', 'flood', 'nikolic', 'juan', 'procp', 'hector', 'pdf', 'kocher', 'restriction', 'team', 'inode', 'multiple', 'transition', 'attribute', 'upload', 'gcp', 'toolkit', 'malicious', 'redefine', 'android', 'delivery', 'xenial', 'breakout', 'libxkbcommon', 'improper', 'david', 'recvmsg', 'engine', 'freetype', 'interact', 'stefan', 'decryption', 'directive', 'datacom', 'blacklist', 'bell', 'wilhelm', 'kaiser', 'replication', 'sufficient', 'tsubasa', 'score', 'graphite', 'zlib', 'libvirt', 'successful', 'procfs', 'cache', 'fan', 'negatively', 'dawid', 'applet', 'leak', 'coder', 'leave', 'expensive', 'invalid', 'task', 'green', 'rubygem', 'random', 'receive', 'scope', 'life', 'originate', 'cipher', 'common', 'abhishek', 'persistent', 'anonymous', 'terrence', 'skip', 'francisco', 'alexey', 'setuid', 'traversal', 'vladimir', 'inspection', 'instantis', 'scan', 'serial', 'ryan', 'communication', 'history', 'plaintext', 'workbench', 'factory', 'attempt', 'unpacked', 'notification', 'admin', 'store', 'extension', 'language', 'blink', 'restore', 'indexed', 'disclosure', 'relnote', 'santillan', 'feature', 'drop', 'mac', 'ul', 'emulate', 'syscall', 'easy', 'potential', 'action', 'add', 'tty', 'fratric', 'torvald', 'openshift', 'tab', 'sky', 'sebastian', 'https', 'lunde', 'validation', 'privileges', 'token', 'tencent', 'shankara', 'salesforce', 'mediaserver', 'mount', 'debuginfo', 'pi', 'alvaro', 'travis', 'steven', 'exhaustion', 'ken', 'reader', 'encode', 'recover', 'white', 'jon', 'outer', 'document', 'karthikeyan', 'grade', 'implement', 'pixbuf', 'wordpress', 'cvename', 'lichvar', 'libre', 'ian', 'andy', 'sergey', 'proxy', 'exploit', 'infrastructure', 'direct', 'golubovic', 'encapsulation', 'video', 'lightweight', 'administrator', 'codec', 'changelog', 'cluster', 'hyperlink', 'pehrson', 'start', 'view', 'depend', 'orient', 'monkey', 'mixed', 'foreign', 'andr', 'identify', 'chancel', 'ceph', 'squid', 'executable', 'manifest', 'tree', 'refer', 'nki', 'armin', 'block', 'hwe', 'helper', 'najjarpour', 'blob', 'tracker', 'orlitzky', 'mateusz', 'detach', 'mod', 'matias', 'initialize', 'report', 'jouni', 'loading', 'host', 'jenkins', 'iceweasel', 'incorrect', 'francesco', 'playback', 'info', 'coppeard', 'constraint', 'sign', 'node', 'upstream', 'vranken', 'compute', 'libpng', 'reply', 'urllib', 'command', 'lutomirski', 'compile', 'imagemagick', 'proc', 'poison', 'resolver', 'xen', 'strategy', 'polska', 'jonathan', 'phil', 'ansible', 'ensure', 'permissive', 'andrey', 'vyukov', 'mariadb', 'broadcast', 'newsham', 'reliable', 'setsockopt', 'nofollow', 'richard', 'single', 'define', 'apr', 'cve', 'pidgin', 'memcached', 'libxml', 'berkeley', 'disabled', 'offload', 'kerschbaumer', 'denial', 'bolter', 'nicholas', 'performance', 'cormack', 'press', 'abuse', 'boo', 'certificate', 'cirrus', 'mware', 'map', 'fink', 'jose', 'debug', 'execute', 'organization', 'unavailability', 'alex', 'viewer', 'calculation', 'attack', 'libmspack', 'offset', 'gem', 'ice', 'marina', 'wes', 'gluster', 'polymorphic', 'monitoring', 'email', 'bos', 'screen', 'knuutinen', 'proximate', 'basic', 'fermin', 'matti', 'carl', 'packard', 'francois', 'cole', 'readable', 'branco', 'exploitable', 'kevin', 'serialize', 'pv', 'walden', 'willard', 'port', 'chen', 'day', 'cisco', 'redirect', 'require', 'hardware', 'enterprise', 'kernel', 'unauthenticated', 'panel', 'style', 'analysis', 'armor', 'underlie', 'odin', 'status', 'vuln', 'spice', 'init', 'resilient', 'tobias', 'simple', 'dev', 'ben', 'hawke', 'session', 'jabbari', 'gomes', 'server', 'surface', 'real', 'hub', 'konovalov', 'iso', 'postgre', 'advanced', 'advisory', 'setup', 'rock', 'expression', 'boris', 'evans', 'secure', 'recursive', 'sanitize', 'cpujul', 'jyl', 'cookie', 'trusty', 'dan', 'database', 'zhani', 'output', 'download', 'froyd', 'generation', 'db', 'traberg', 'hickey', 'unbounded', 'mevied', 'realtime', 'identifie', 'libavcodec', 'krb', 'enforce', 'ability', 'unix', 'fs', 'bsc', 'unauthorized', 'color', 'exchange', 'inspect', 'carlo', 'animation', 'pointer', 'infinite', 'introduce', 'atte', 'incoming', 'jordi', 'post', 'signature', 'content', 'trend', 'contrary', 'plain', 'wang', 'repository', 'violate', 'fetch', 'optimizer', 'jasper', 'location', 'key', 'miller', 'hotspot', 'internal', 'qiang', 'datagram', 'interrupt', 'extended', 'recommend', 'divide', 'attach', 'perl', 'systems', 'pin', 'filter', 'po', 'telecommunications'],
                  ['nan', 'image', 'felix', 'product', 'android', 'handle', 'holler', 'origin', 'submit', 'improper', 'jeff', 'render', 'query', 'additional', 'bnc', 'dnsmasq', 'david', 'software', 'build', 'signing', 'clary', 'check', 'chakra', 'engine', 'creight', 'bin', 'stefan', 'leap', 'setting', 'mohamed', 'wilhelm', 'endpoint', 'nicolas', 'replication', 'socket', 'score', 'graphite', 'hat', 'libvirt', 'university', 'cache', 'arya', 'restricted', 'instal', 'consumption', 'daniel', 'window', 'time', 'maintenance', 'sandbox', 'qihoo', 'middle', 'privilege', 'deny', 'applet', 'print', 'boss', 'manipulate', 'leak', 'review', 'method', 'range', 'connect', 'affect', 'mozilla', 'invalid', 'task', 'apply', 'desktop', 'unknown', 'valid', 'include', 'nest', 'spoof', 'property', 'execution', 'receive', 'qemu', 'life', 'tomcat', 'error', 'environment', 'addition', 'scientific', 'jann', 'fragment', 'deployment', 'common', 'stream', 'structure', 'francis', 'edge', 'specific', 'archive', 'navigation', 'abhishek', 'live', 'anonymous', 'thunderbird', 'tim', 'libarchive', 'aarch', 'original', 'browser', 'integer', 'mode', 'cryptography', 'account', 'log', 'traversal', 'insecure', 'identifier', 'hang', 'cloud', 'scan', 'discover', 'input', 'ryan', 'race', 'function', 'history', 'datum', 'platform', 'core', 'raw', 'enable', 'management', 'attempt', 'httpd', 'critical', 'google', 'gabriel', 'improperly', 'firefox', 'store', 'extension', 'determine', 'samba', 'language', 'traffic', 'variable', 'entity', 'restore', 'filename', 'create', 'vulnerability', 'disclosure', 'allocation', 'relnote', 'timing', 'netfilter', 'andrea', 'feature', 'deadlock', 'raspi', 'partial', 'satellite', 'prior', 'ul', 'disclose', 'upgrading', 'support', 'lib', 'kit', 'thread', 'crane', 'module', 'downgrade', 'architecture', 'layer', 'easy', 'graphic', 'broadcom', 'potential', 'ralf', 'ext', 'action', 'newsgroup', 'add', 'abdulrahman', 'ethernet', 'power', 'torvald', 'hanno', 'filesystem', 'construct', 'remove', 'https', 'validation', 'storage', 'xstore', 'resource', 'privileges', 'token', 'encryption', 'tencent', 'condition', 'container', 'frame', 'list', 'bar', 'salesforce', 'pende', 'path', 'le', 'mount', 'debuginfo', 'pi', 'root', 'nan', 'chrome', 'message', 'result', 'format', 'browse', 'exhaustion', 'reader', 'embed', 'ronald', 'looben', 'set', 'provide', 'office', 'family', 'active', 'bind', 'document', 'request', 'untrusted', 'implement', 'iframe', 'yang', 'algorithm', 'intel', 'metadata', 'cvename', 'local', 'permission', 'rule', 'holger', 'solution', 'workstation', 'andy', 'azure', 'curl', 'emulator', 'incorrectly', 'consume', 'proxy', 'exploit', 'overflow', 'libstagefright', 'tyson', 'unspecified', 'disable', 'jacob', 'interpreter', 'video', 'network', 'randomization', 'framework', 'security', 'qualcomm', 'creation', 'cluster', 'href', 'context', 'decode', 'allocate', 'start', 'view', 'escape', 'paul', 'metzmacher', 'overwrite', 'failure', 'aws', 'inno', 'wireless', 'ceph', 'argument', 'incomplete', 'squid', 'buffer', 'script', 'malforme', 'byron', 'refer', 'windows', 'field', 'occur', 'block', 'response', 'size', 'patch', 'link', 'django', 'raspberry', 'violation', 'credential', 'dmitry', 'gustavo', 'type', 'endian', 'mod', 'lts', 'initialize', 'report', 'injection', 'bob', 'cgi', 'loading', 'robert', 'manager', 'host', 'dereference', 'wei', 'update', 'van', 'randell', 'incorrect', 'extract', 'space', 'character', 'hash', 'policy', 'mail', 'node', 'physically', 'upstream', 'martin', 'compute', 'excessive', 'ghannam', 'command', 'labs', 'lutomirski', 'configuration', 'shift', 'crash', 'bug', 'plugin', 'imagemagick', 'bobby', 'addressbar', 'invoke', 'encrypt', 'properly', 'trigger', 'driver', 'adam', 'mark', 'remote', 'addon', 'en', 'grieco', 'administrative', 'services', 'machine', 'kwong', 'serialization', 'audio', 'display', 'lab', 'form', 'protection', 'conduct', 'exist', 'xu', 'utility', 'moritz', 'ansible', 'logic', 'ensure', 'muneaki', 'andrey', 'device', 'fmpeg', 'authorization', 'amazon', 'bmo', 'vyukov', 'timer', 'jukka', 'processor', 'impact', 'alexander', 'client', 'michael', 'version', 'reliable', 'jan', 'ioctl', 'mysql', 'configure', 'generic', 'exposure', 'directory', 'zbarsky', 'christoph', 'memory', 'debugger', 'single', 'define', 'campen', 'cve', 'expose', 'supply', 'exiv', 'computing', 'force', 'physical', 'libxml', 'arbitrary', 'disabled', 'file', 'user', 'monitor', 'book', 'channel', 'craft', 'confidential', 'litchfield', 'connector', 'openjdk', 'denial', 'zip', 'fail', 'option', 'runtime', 'kvm', 'corruption', 'font', 'performance', 'medium', 'protocol', 'onapsis', 'boo', 'inconvenience', 'symlink', 'tool', 'attacker', 'certificate', 'collection', 'library', 'install', 'confidentiality', 'spenneberg', 'map', 'combination', 'debug', 'login', 'phar', 'jose', 'execute', 'eric', 'object', 'gary', 'loop', 'alex', 'intend', 'partition', 'openssl', 'fc', 'ppc', 'safety', 'search', 'parameter', 'attack', 'partially', 'news', 'gem', 'header', 'insufficient', 'load', 'password', 'vector', 'gluster', 'privilige', 'prevent', 'situation', 'developer', 'domain', 'crypto', 'apache', 'ruby', 'operation', 'andrew', 'monitoring', 'email', 'array', 'layout', 'researcher', 'proximate', 'access', 'send', 'correctly', 'instance', 'project', 'code', 'perform', 'schema', 'elevate', 'lead', 'level', 'escalate', 'thomas', 'florian', 'cross', 'privileged', 'bound', 'development', 'ruderman', 'authenticate', 'servlet', 'trustwave', 'middleware', 'unable', 'pv', 'jackson', 'php', 'connection', 'jesup', 'standard', 'carsten', 'limit', 'guest', 'availability', 'port', 'jesse', 'exception', 'chen', 'event', 'trick', 'mechanism', 'bit', 'day', 'modify', 'cisco', 'authentication', 'redirect', 'require', 'hardware', 'virtualization', 'emulation', 'enterprise', 'heap', 'processing', 'kernel', 'unauthenticated', 'reportin', 'program', 'incompatible', 'integrity', 'address', 'reference', 'keyring', 'builder', 'resilient', 'kangjie', 'dev', 'session', 'jakub', 'server', 'component', 'ubuntu', 'sound', 'regression', 'specially', 'unprivileged', 'real', 'notes', 'netlink', 'konovalov', 'steal', 'iso', 'advanced', 'advisory', 'rockit', 'issue', 'linux', 'target', 'automate', 'ready', 'rock', 'expression', 'technetwork', 'wrong', 'boris', 'release', 'drag', 'worker', 'controller', 'parse', 'secure', 'cookie', 'verification', 'trusty', 'body', 'mmap', 'source', 'fuhrmannek', 'git', 'horn', 'alqabandi', 'smith', 'christian', 'database', 'fault', 'enablement', 'process', 'circumstance', 'vulnerable', 'magick', 'parser', 'bypass', 'record', 'manipulation', 'operate', 'base', 'note', 'escalation', 'initiative', 'mitre', 'verify', 'track', 'stack', 'holley', 'control', 'descriptor', 'service', 'micro', 'string', 'wi', 'identifie', 'oracle', 'sensitive', 'scripting', 'flaw', 'enforce', 'john', 'inject', 'doc', 'fs', 'bsc', 'cryptographic', 'unauthorized', 'application', 'exchange', 'pointer', 'infinite', 'share', 'subsystem', 'meta', 'jas', 'debian', 'instruction', 'packet', 'red', 'implementation', 'signature', 'content', 'trend', 'element', 'apologize', 'daemon', 'snapdragon', 'handler', 'wang', 'optimizer', 'location', 'key', 'deserialization', 'hotspot', 'read', "'cause", 'internal', 'description', 'datagram', 'javascript', 'extended', 'restriction', 'write', 'team', 'multiple', 'systems', 'wen', 'attribute', 'nishimura', 'cycle', 'maria', 'behavior', 'filter', 'validate', 'diehl', 'entry', 'change', 'malicious', 'bluetooth', 'gain'],
                  ['nan', 'driver', 'resource', 'image', 'trick', 'remote', 'day', 'modify', 'condition', 'authentication', 'list', 'handle', 'services', 'origin', 'le', 'virtualization', 'mount', 'enterprise', 'heap', 'processing', 'kernel', 'nan', 'conduct', 'exist', 'message', 'david', 'software', 'result', 'check', 'embed', 'integrity', 'address', 'reference', 'andrey', 'set', 'device', 'leap', 'dev', 'request', 'session', 'impact', 'socket', 'client', 'server', 'component', 'ubuntu', 'version', 'specially', 'hat', 'local', 'mysql', 'konovalov', 'memory', 'advisory', 'issue', 'solution', 'linux', 'workstation', 'target', 'restricted', 'expose', 'incorrectly', 'time', 'maintenance', 'sandbox', 'exploit', 'computing', 'overflow', 'privilege', 'parse', 'unspecified', 'boss', 'arbitrary', 'leak', 'review', 'file', 'user', 'mozilla', 'desktop', 'source', 'network', 'craft', 'include', 'spoof', 'security', 'christian', 'database', 'execution', 'process', 'denial', 'circumstance', 'magick', 'life', 'context', 'error', 'bypass', 'environment', 'scientific', 'base', 'escalation', 'corruption', 'initiative', 'protocol', 'attacker', 'stack', 'collection', 'library', 'service', 'thunderbird', 'control', 'buffer', 'aarch', 'script', 'malforme', 'browser', 'integer', 'execute', 'oracle', 'sensitive', 'scripting', 'flaw', 'occur', 'object', 'patch', 'bsc', 'identifier', 'cloud', 'application', 'discover', 'input', 'fc', 'ppc', 'function', 'race', 'pointer', 'datum', 'platform', 'subsystem', 'safety', 'core', 'type', 'endian', 'attack', 'partially', 'enable', 'google', 'firefox', 'load', 'packet', 'report', 'red', 'extension', 'samba', 'cgi', 'implementation', 'situation', 'host', 'manager', 'dereference', 'update', 'content', 'apache', 'properly', 'create', 'vulnerability', 'disclosure', 'proximate', 'access', 'send', 'project', 'code', 'perform', 'key', 'partial', 'satellite', 'read', "'cause", 'elevate', 'support', 'lead', 'kit', 'policy', 'ul', 'node', 'cross', 'physically', 'module', 'description', 'privileged', 'extended', 'bound', 'development', 'compute', 'ext', 'restriction', 'command', 'authenticate', 'write', 'team', 'multiple', 'systems', 'configuration', 'cycle', 'power', 'connection', 'crash', 'bug', 'filesystem', 'validate', 'guest', 'availability', 'malicious', 'invoke', 'gain', 'trigger'],
                  ['nan', 'driver', 'image', 'trick', 'remote', 'modify', 'condition', 'handle', 'services', 'le', 'enterprise', 'kernel', 'exist', 'software', 'reference', 'client', 'server', 'component', 'ubuntu', 'specially', 'hat', 'local', 'memory', 'issue', 'solution', 'linux', 'workstation', 'target', 'restricted', 'expose', 'incorrectly', 'maintenance', 'exploit', 'overflow', 'privilege', 'arbitrary', 'file', 'user', 'desktop', 'network', 'craft', 'security', 'execution', 'denial', 'error', 'bypass', 'attacker', 'collection', 'library', 'service', 'buffer', 'execute', 'oracle', 'sensitive', 'flaw', 'occur', 'application', 'discover', 'ppc', 'function', 'datum', 'endian', 'attack', 'partially', 'firefox', 'report', 'red', 'implementation', 'update', 'content', 'properly', 'vulnerability', 'access', 'code', 'read', "'cause", 'elevate', 'support', 'lead', 'node', 'description', 'extended', 'compute', 'authenticate', 'multiple', 'systems', 'power', 'crash', 'invoke', 'gain', 'trigger'],
                  ['nan', 'hat', 'update', 'local', 'remote', 'attacker', 'memory', 'issue', 'collection', 'linux', 'service', 'condition', 'target', 'solution', 'handle', 'services', 'vulnerability', 'le', 'enterprise', 'exploit', 'code', 'privilege', 'kernel', 'execute', 'oracle', 'flaw', "'cause", 'software', 'support', 'arbitrary', 'file', 'user', 'extended', 'application', 'discover', 'craft', 'ppc', 'datum', 'endian', 'multiple', 'systems', 'security', 'denial', 'power', 'crash', 'red', 'server', 'component', 'specially'],
                  ['nan', 'component', 'user', 'extended', 'endian', "'cause", 'red', 'support', 'code', 'kernel', 'crash', 'remote', 'service', 'ppc', 'le', 'flaw', 'linux', 'software', 'exploit', 'attacker', 'vulnerability', 'collection', 'enterprise', 'arbitrary', 'update', 'denial', 'server', 'discover', 'power', 'hat']
                ]           

# for i in range(6):
#     print(REFERENCES_ALL[i])


# percentage = [0.95, 0.9, 0.8, 0.7, 0.6, 0.5]
# number = [5, 6, 7, 8, 9, 10, 13, 15, 20]
# count = 0
# for i in percentage:
#     for j in number:
#         REFERENCES = REFERENCES_ALL[count]
#         generate_new_csv(i, j)
#     count += 1

REFERENCES = REFERENCES_ALL[0]
generate_new_csv(0.8, 13)